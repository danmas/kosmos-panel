# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∞ SSH –≤ Kosmos Panel

–≠—Ç–æ—Ç —Ñ–∞–π–ª –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ SSH –¥–ª—è –ø–∞–Ω–µ–ª–∏, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç ¬´–≥–æ—Ä—è—á–∞—è¬ª –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –∏ –∫–∞–∫ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –∏ tail –ª–æ–≥–æ–≤.

## –ì–¥–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–µ–∂–∞—Ç –≤ `inventory.json`:
- –ë–ª–æ–∫ `credentials`: –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–ø–æ—Å–æ–±—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∫–ª—é—á/–ø–∞—Ä–æ–ª—å/–∞–≥–µ–Ω—Ç)
- –ü–æ–ª–µ `ssh` —É –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞: —É–∫–∞–∑—ã–≤–∞–µ—Ç `host`, `port`, `user`, `credentialId`

–ü—Ä–∏–º–µ—Ä:
```json
{
  "credentials": [
    {
      "id": "cred-sample",
      "type": "ssh-key",
      "privateKeyPath": "C:/Users/you/.ssh/id_ed25519",
      "passphrase": null,
      "useAgent": false,
      "password": null
    }
  ],
  "servers": [
    {
      "id": "usa",
      "name": "usa",
      "env": "prod",
      "ssh": { "host": "usa", "port": 22, "user": "ubuntu", "credentialId": "cred-sample" },
      "services": [
        { "id": "usa-web", "type": "http", "name": "USA Web", "url": "http://usa:3002", "expectStatus": 200 }
      ]
    }
  ]
}
```

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–æ–ª—è –≤ `credentials`:
- `type`: –≤—Å–µ–≥–¥–∞ `ssh-key` (–¥–ª—è –∫–ª—é—á–µ–π)
- `privateKeyPath`: –ø—É—Ç—å –¥–æ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `C:/Users/<—Ç—ã>/.ssh/id_ed25519`)
- `passphrase`: –ø–∞—Ä–æ–ª—å –∫ –∫–ª—é—á—É, –µ—Å–ª–∏ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- `useAgent`: –µ—Å–ª–∏ `true`, –ø–∞–Ω–µ–ª—å –ø–æ–ø—Ä–æ–±—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SSH‚Äë–∞–≥–µ–Ω—Ç (`SSH_AUTH_SOCK` –∏–ª–∏ Pageant –Ω–∞ Windows)
- `password`: –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–∞—Ä–æ–ª—å –¥–ª—è –ª–æ–≥–∏–Ω–∞ –ø–æ –ø–∞—Ä–æ–ª—é (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è; —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)

–ü—Ä–∏–º–µ—á–∞–Ω–∏—è –¥–ª—è Windows:
- –ß–∞—Å—Ç–æ –∫–ª—é—á ‚Äî `id_ed25519`, –∞ –Ω–µ `id_rsa`
- –ü—É—Ç—å —É–∫–∞–∑—ã–≤–∞–π—Ç–µ Windows‚Äë—Å—Ç–∏–ª–µ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä `C:/Users/<—Ç—ã>/.ssh/id_ed25519`

## –ì–æ—Ä—è—á–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–ü–∞–Ω–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞–µ—Ç `inventory.json` –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏:
- –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–∞–π–ª–æ–≤—ã–π –≤–æ—Ç—á–µ—Ä
- –ö–æ–Ω—Ñ–∏–≥ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è ¬´–Ω–∞ –ª–µ—Ç—É¬ª
- –ö—ç—à –∫–ª—é—á–µ–π –æ—á–∏—â–∞–µ—Ç—Å—è, –Ω–æ–≤—ã–µ –ø—É—Ç–∏/–ø–∞—Ä–æ–ª–∏ –±–µ—Ä—É—Ç—Å—è –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π `pollOnce()` (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤)

–¢–∞–∫–∂–µ –µ—Å—Ç—å —Ä—É—á–Ω–æ–π —ç–Ω–¥–ø–æ–π–Ω—Ç:
- `POST /api/reload` ‚Äî –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—á–∏—Ç–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥

–í–∞–∂–Ω–æ: —É–∂–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ SSH‚Äë—Å–µ—Å—Å–∏–∏ (—Ç–µ—Ä–º–∏–Ω–∞–ª/tail) –Ω–µ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è ‚Äî –æ—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ SSH (–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞)

–ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç —Å —Å–µ—Ä–≤–µ—Ä–∞ –ø–∞–Ω–µ–ª–∏:
- –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `http://localhost:3000/api/test-ssh?serverId=<id>`
- –£—Å–ø–µ—Ö:
  ```json
  { "ok": true, "result": { "stdout": "__OK__" } }
  ```
- –û—à–∏–±–∫–∞: –±—É–¥–µ—Ç `{ ok:false, error:"..." }` ‚Äî –ø–æ —Ç–µ–∫—Å—Ç—É —Å—Ç–∞–Ω–µ—Ç —è—Å–Ω–æ, –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∫–ª—é—á–µ/–ø–∞—Ä–æ–ª–µ/—é–∑–µ—Ä–µ/—Å–µ—Ç–∫–µ

–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç–∞ 22 (Windows PowerShell):
```
Test-NetConnection <host> -Port 22
```
–û–∂–∏–¥–∞–µ–º `TcpTestSucceeded: True`.

## –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –∏ tail

- UI –ø–∏—à–µ—Ç –ø—Ä–∏—á–∏–Ω—ã –æ—à–∏–±–æ–∫ –≤–æ –≤—Å–ø–ª—ã–≤–∞—é—â–µ–º –æ–≤–µ—Ä–ª–µ–µ (—Å–æ–æ–±—â–µ–Ω–∏—è `[FATAL] ...`)
- –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–∞–Ω–µ–ª–∏ —Å–º–æ—Ç—Ä–∏—Ç–µ –∫–æ–Ω—Å–æ–ª—å `node` ‚Äî –ª–æ–≥–∏ `"[ws] terminal ..."`/`"[ws] tail ..."` –∏ –æ—à–∏–±–∫–∏ ssh2
- –¢–∏–ø–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è:
  - –ù–µ–≤–µ—Ä–Ω—ã–π –ø—É—Ç—å –∫ –∫–ª—é—á—É ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `privateKeyPath`
  - –ö–ª—é—á —Å –ø–∞—Ä–æ–ª–µ–º ‚Üí —É–∫–∞–∂–∏—Ç–µ `passphrase`
  - –ù–µ–≤–µ—Ä–Ω—ã–π `user` ‚Üí –ø–æ–ø—Ä–∞–≤—å—Ç–µ `ssh.user` —É —Å–µ—Ä–≤–µ—Ä–∞
  - –î–æ—Å—Ç—É–ø –∑–∞–∫—Ä—ã—Ç —Ñ–∞–µ—Ä–≤–æ–ª–æ–º ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `Test-NetConnection`
  - –ù—É–∂–µ–Ω –∞–≥–µ–Ω—Ç ‚Üí —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `useAgent: true` (Pageant/OpenSSH Agent), –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–ª—é—á –≤ –∞–≥–µ–Ω—Ç
  - –í –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ, –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–¥–∞—Ç—å `password` –≤ `credentials`

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `password` –¥–æ–ø—É—Å—Ç–∏–º–æ —Ç–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –ü—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ ‚Äî –∫–ª—é—á–∏ —Å `passphrase` –∏–ª–∏ SSH‚Äë–∞–≥–µ–Ω—Ç

## –ü–æ–≤–µ–¥–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ (WS)

- –≠–Ω–¥–ø–æ–π–Ω—Ç: `/ws/terminal?serverId=...&cols=120&rows=30`
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ UI –ø–æ–∫–∞–∂–µ—Ç `[FATAL] ...` —Å –ø—Ä–∏—á–∏–Ω–æ–π
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—Ä–µ–¥–æ–≤ –æ—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ–≤—É—é –≤–∫–ª–∞–¥–∫—É —Ç–µ—Ä–º–∏–Ω–∞–ª–∞

## Tail –ª–æ–≥–æ–≤ (WS)

- –≠–Ω–¥–ø–æ–π–Ω—Ç: `/ws/tail?serverId=...&path=/var/log/syslog&lines=200`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ –∂–µ –∫—Ä–µ–¥—ã SSH, —á—Ç–æ –∏ —Ç–µ—Ä–º–∏–Ω–∞–ª
- –ü—Ä–∏ –æ—à–∏–±–∫–µ —Ç–∞–∫–∂–µ –ø—Ä–∏–¥—ë—Ç `[FATAL] ...`

üìñ **–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ç–µ—Ä–º–∏–Ω–∞–ª—É**: [README_terminal.md](README_terminal.md)


