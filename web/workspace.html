<!doctype html>
<html lang="ru">

<head>
    <meta charset="utf-8" />
    <title>Workspace ‚Äî Kosmos Panel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://unpkg.com/xterm/css/xterm.css" />
    <script src="https://unpkg.com/xterm/lib/xterm.js"></script>
    <script src="https://unpkg.com/xterm-addon-fit/lib/xterm-addon-fit.js"></script>
    <link rel="stylesheet" href="./themes.css" />
    <link rel="stylesheet" href="./workspace.css" />
</head>

<body>
    <!-- Top Bar -->
    <div class="ws-topbar">
        <div class="ws-topbar-title">‚ö° Workspace</div>
        <div class="ws-topbar-server" id="wsServerName">‚Äî</div>
        <div class="ws-topbar-session" id="wsSessionId" title="Session ID (click to copy)">‚Äî</div>
        <div class="ws-topbar-spacer"></div>
        <select class="theme-selector topbar-link"
            style="background:transparent; border:none; color:var(--text-muted); padding:4px; max-width:80px; margin-right:10px;"
            title="–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è"></select>
        <button id="wsReconnect" class="btn-reconnect">–ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å</button>
        <button id="wsFit">–ü–æ–¥–æ–≥–Ω–∞—Ç—å</button>
        <button id="wsClose" class="btn-close">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <!-- Main Layout: Left Sidebar + Drag Handle + Right Terminal -->
    <div class="ws-layout">

        <!-- Left Sidebar -->
        <div class="ws-left" id="wsLeft">

            <!-- Left Top: Logs/History -->
            <div class="ws-left-top" id="wsLeftTop">
                <div class="ws-tabs" id="logTabs">
                    <button class="ws-tab active" data-tab="terminal">üíª Terminal</button>
                    <button class="ws-tab" data-tab="skills">‚ú® Skills</button>
                </div>
                <!-- Filters for terminal logs -->
                <div class="ws-filters" id="terminalFilters">
                    <button class="ws-filter-btn active" data-type="all">–í—Å–µ</button>
                    <button class="ws-filter-btn" data-type="ai_query">AI</button>
                    <button class="ws-filter-btn" data-type="stdin">–ö–æ–º–∞–Ω–¥—ã</button>
                    <button class="ws-filter-btn" data-type="stdout">–í—ã–≤–æ–¥</button>
                    <button class="ws-filter-btn" data-type="stderr">–û—à–∏–±–∫–∏</button>
                </div>
                <!-- Filters for skills logs -->
                <div class="ws-filters hidden" id="skillsFilters">
                    <button class="ws-filter-btn active" data-type="all">–í—Å–µ</button>
                    <button class="ws-filter-btn" data-type="skill_start">–ó–∞–ø—É—Å–∫</button>
                    <button class="ws-filter-btn" data-type="skill_command">–ö–æ–º–∞–Ω–¥—ã</button>
                    <button class="ws-filter-btn" data-type="skill_command_output">Output</button>
                    <button class="ws-filter-btn" data-type="skill_message">–ò–Ω—Ñ–æ</button>
                    <button class="ws-filter-btn" data-type="skill_ask">–í–æ–ø—Ä–æ—Å—ã</button>
                    <button class="ws-filter-btn" data-type="skill_complete">–ì–æ—Ç–æ–≤–æ</button>
                </div>
                <div class="ws-panel-content" id="logsContent">
                    <div class="ws-empty">–ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ–≤...</div>
                </div>
            </div>

            <!-- Horizontal Drag Handle -->
            <div class="ws-drag-h" id="wsDragH"></div>

            <!-- Left Bottom: Skills -->
            <div class="ws-left-bottom" id="wsLeftBottom">
                <div class="ws-tabs">
                    <button class="ws-tab active">üõ† Skills</button>
                </div>
                <!-- Skills list or active skill dialog -->
                <div class="ws-panel-content" id="skillsPanel">
                    <div class="ws-skills-loading">–ó–∞–≥—Ä—É–∑–∫–∞ skills...</div>
                </div>
                <!-- Skill params form (shown when skill selected) -->
                <div class="ws-skill-params-form hidden" id="wsSkillParamsForm">
                    <div class="ws-skill-params-title">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è <span id="wsSkillParamsName"></span>:</div>
                    <div class="ws-skill-param-input">
                        <input type="text" id="wsSkillParamsInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã...">
                        <button class="ws-skill-execute-btn" id="wsSkillExecuteBtn">‚ñ∂</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vertical Drag Handle -->
        <div class="ws-drag-v" id="wsDragV"></div>

        <!-- Right: Terminal -->
        <div class="ws-right" id="wsRight">
            <div id="wsTerm" class="ws-term"></div>

            <!-- Remote command confirmation -->
            <div id="wsCommandConfirm" class="ws-command-confirm hidden">
                <div class="ws-command-confirm-header">
                    <span class="ws-command-confirm-badge">REST API</span>
                    <span>–£–¥–∞–ª—ë–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</span>
                </div>
                <div class="ws-command-confirm-text" id="wsCommandConfirmText"></div>
                <div class="ws-command-confirm-buttons">
                    <button class="ws-btn-reject" id="wsConfirmNo">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                    <button class="ws-btn-skip" id="wsConfirmSkip">–ë–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</button>
                    <button class="ws-btn-confirm" id="wsConfirmYes">–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Skill create/edit dialog -->
    <div id="wsSkillCreateOverlay" class="ws-skill-create-overlay hidden"></div>
    <div id="wsSkillCreateDialog" class="ws-skill-create-dialog hidden">
        <div class="ws-skill-create-header" id="wsSkillCreateHeader">
            <span class="ws-skill-create-title" id="wsSkillCreateTitle">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å Skill</span>
            <button class="ws-skill-create-close" id="wsSkillCreateClose">√ó</button>
        </div>
        <div class="ws-skill-create-body">
            <div class="ws-skill-create-path" id="wsSkillCreatePath">–ü—É—Ç—å: ...</div>
            <div class="ws-skill-create-field">
                <label class="ws-skill-create-label">–ò–º—è skill (–ª–∞—Ç–∏–Ω–∏—Ü–∞, –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤)</label>
                <input type="text" class="ws-skill-create-input" id="wsSkillCreateName" placeholder="my-skill-name" autocomplete="off">
            </div>
            <div class="ws-skill-create-field" style="flex:1; display:flex; flex-direction:column;">
                <label class="ws-skill-create-label">–°–æ–¥–µ—Ä–∂–∏–º–æ–µ SKILL.md</label>
                <textarea class="ws-skill-create-textarea" id="wsSkillCreateContent" placeholder="---&#10;name: my-skill&#10;description: –û–ø–∏—Å–∞–Ω–∏–µ&#10;---&#10;..."></textarea>
            </div>
            <div class="ws-skill-create-error hidden" id="wsSkillCreateError"></div>
        </div>
        <div class="ws-skill-create-footer">
            <button class="ws-skill-create-btn ws-skill-create-btn-cancel" id="wsSkillCreateCancel">–û—Ç–º–µ–Ω–∞</button>
            <button class="ws-skill-create-btn ws-skill-create-btn-save" id="wsSkillCreateSave">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <script src="./theme-manager.js"></script>
    <script src="./workspace.js"></script>
</body>

</html>