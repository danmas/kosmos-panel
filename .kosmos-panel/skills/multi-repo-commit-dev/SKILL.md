---
name: multi-repo-commit-dev
description: Массовый коммит и пуш изменений в репозиториях (ветка dev). Не останавливается пока не пройдет все папки.
params:
  - name: branch
    description: Целевая ветка (по умолчанию "dev")
---

## Context
Я — автоматический скрипт для обслуживания репозиториев.
Моя задача — пройтись по всем заданным папкам, проверить их состояние и закоммитить изменения.

## Список папок (Очередь выполнения)
1. `C:\ERV\projects-ex\kosmos-model`
2. `C:\ERV\projects-ex\kosmos-panel`
3. `C:\ERV\projects-ex\kosmos-vector`
4. `C:\ERV\projects-ex\kosmos-vector-UI`

## Состояние и Память
Ты должен помнить, на какой папке остановился.
- Если ты только начал -> Папка 1.
- Если закончил Папку 1 -> Переходи к Папке 2.
- ... и так далее.

## Алгоритм (Строго выполняй по шагам!)

**ВАЖНО**: Получив вывод команды, НЕ СПРАШИВАЙ "Что дальше?", а СРАЗУ ГЕНЕРИРУЙ КОМАНДУ для следующего шага или следующей папки.

### Шаг 1: Проверка папки (CMD)
Сгенерируй команду: `cd /d <путь_к_текущей_папке> && git branch --show-current && git status --short`

### Шаг 2: Анализ результата (В уме)
Получив вывод предыдущей команды:
1. **Проверь ветку**: Если это не `dev` (или user branch), запомни ошибку.
2. **Проверь статус**:
   - Если после имени ветки ПУСТО (нет файлов), значит изменений нет.
   - Если есть список файлов, значит нужны изменения.

### Шаг 3: Действие (ASK или CMD)
- **Сценарий А: Ветка не та ИЛИ Изменений нет**
  - Сразу генерируй команду для **СЛЕДУЮЩЕЙ** папки из списка (переходи к Шагу 1 для новой папки).
  - *Пример вывода для себя*: "Папка 1 чиста. Перехожу к папке 2." -> `cd /d ...`

- **Сценарий Б: Есть изменения**
  - (ASK) Спроси пользователя сообщение для коммита именно этой папки.
  - Получив ответ, сгенерируй: `git add . && git commit -m "..." && git push origin dev`
  - После успешного пуша -> Сразу генерируй команду для **СЛЕДУЮЩЕЙ** папки.

### Шаг 4: Финал (DONE)
Только когда проверена ПОСЛЕДНЯЯ папка (kosmos-vector-UI):
- Выведи отчет:
  - Model: ...
  - Panel: ...
  - Vector: ...
  - UI: ...
- Заверши работу.

## Критические правила
- Если `git status` вернул пустоту — это НЕ повод останавливаться. Это повод бежать к следующей папке!
- Не жди похвалы от пользователя. Работай как конвейер.
