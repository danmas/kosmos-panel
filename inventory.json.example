{
  "credentials": [
    {
      "id": "cred-sample",
      "type": "ssh-key",
      "privateKeyPath": "${SSH_KEY_PATH}",
      "passphrase": "${SSH_PASSPHRASE}",
      "password": "${SSH_USA_PASSWORD}",
      "useAgent": "${USE_SSH_AGENT}"
    },
    {
      "id": "cred-w2-office",
      "type": "ssh-key",
      "privateKeyPath": "${SSH_KEY_PATH}",
      "passphrase": "${SSH_PASSPHRASE}",
      "password": "${SSH_OFFICE_W2_PASSWORD}",
      "useAgent": "false"
    }
  ],
  "servers": [
    {
      "id": "id-server-usa",
      "name": "usa - ${VAR_1}",
      "env": "prod",
      "ssh": {
        "host": "usa",
        "port": 22,
        "user": "${SSH_USA_USER}",
        "credentialId": "cred-sample"
      },
      "services": [
        {
          "id": "ping-google",
          "name": "Ping Google",
          "description": "Проверка интернет-соединения до Google",
          "type": "sshCommand",
          "command": "ping -4 -c 4 google.com",
          "okPattern": "4 packets transmitted, 4 received",
          "timeoutMs": 10000
        },
        {
          "id": "aian-model",
          "type": "http",
          "name": "AIAN Model (3002)",
          "description": "AI модель для обработки запросов",
          "url": "http://usa:3002",
          "expectStatus": 200,
          "timeoutMs": 3000
        },
        {
          "id": "searxng-docker",
          "type": "dockerContainer",
          "name": "searxng (doc)",
          "description": "Метапоисковик для приватного поиска",
          "container": "searxng",
          "timeoutMs": 3000
        },
        {
          "id": "pg",
          "type": "sshCommand",
          "name": "postgres",
          "description": "База данных PostgreSQL",
          "command": "pg_isready",
          "okPattern": "accepting connections",
          "timeoutMs": 3000
        }
      ]
    },
    {
      "id": "w2-server",
      "name": "w2 Server",
      "env": "prod",
      "ssh": {
        "host": "${OFFICE_W2_HOST}",
        "port": 22,
        "user": "${SSH_OFFICE_W2_USER}",
        "credentialId": "cred-w2-office"
      },
      "services": [
        {
          "id": "api-http",
          "type": "http",
          "name": "API HTTP Check",
          "url": "http://127.0.0.1:8080/health",
          "expectStatus": 200,
          "timeoutMs": 2000
        },
        {
          "id": "api-json",
          "type": "httpJson",
          "name": "API JSON Check",
          "url": "http://127.0.0.1:8080/health",
          "timeoutMs": 2000,
          "rules": [
            {
              "name": "ok flag",
              "path": "$.ok",
              "equals": true
            },
            {
              "name": "version exists",
              "path": "$.version",
              "exists": true
            }
          ]
        },
        {
          "id": "nginx",
          "type": "systemd",
          "name": "nginx",
          "description": "Веб-сервер и прокси",
          "service": "nginx",
          "timeoutMs": 3000
        },
        {
          "id": "redis",
          "type": "tcp",
          "name": "redis",
          "description": "Кэш и брокер сообщений",
          "host": "127.0.0.1",
          "port": 6379,
          "timeoutMs": 1500
        },
        {
          "id": "tls-google",
          "type": "tls",
          "name": "google tls",
          "host": "google.com",
          "port": 443,
          "minDaysLeft": 7
        },
        {
          "id": "docker-api",
          "type": "dockerContainer",
          "name": "api-container",
          "container": "api"
        }
      ]
    }
  ],
  "poll": {
    "intervalSec": 15,
    "concurrency": 6
  }
}